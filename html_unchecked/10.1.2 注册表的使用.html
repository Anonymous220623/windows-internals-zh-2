<h3 class="bt3" id="sigil_toc_id_108">10.1.2　注册表的使用</h3>
<p class="zw">配置数据的读取主要发生在下列四个时间内。</p>
<p class="zwd"><span style="color: #0092dd">●</span> 初始启动过程中，启动加载器读取配置数据和启动设备驱动程序列表，在内核初始化之前将其载入内存。由于启动配置数据库（Boot Configuration Database，BCD）实际上也存储在注册表配置单元中，因此完全可以说注册表的访问甚至发生在比这更早的时候，即启动管理器显示操作系统列表时就开始访问了。</p>
<p class="zwd"><span style="color: #0092dd">●</span> 内核启动过程中，内核读取设置，这些设置决定了要加载哪些设备驱动程序，以及各种系统元素（如内存管理器和进程管理器）如何配置自己并调整系统行为。</p>
<p class="zwd"><span style="color: #0092dd">●</span> 登录过程中，资源管理器和其他Windows组件从注册表读取每用户的首选项，包括网络驱动器盘符映射、桌面壁纸、屏幕保护程序、菜单行为、图标的布局，以及最重要的：要自动运行的程序以及最近访问过的文件。</p>
<p class="zwd"><span style="color: #0092dd">●</span> 启动过程中，应用程序需要读取系统端设置数据，例如可选安装的组件列表和许可数据，以及每用户设置（可能还包含菜单与工具栏的布局）与最近访问的文档列表。</p>
<p class="zw">其他时候也可以读取注册表，例如要对注册表值或键的改动做出响应时。虽然注册表提供了异步回调，这也是接收变更通知的首选方式，但一些应用程序也会通过轮询持续监视自己在注册表中的配置，并自动应用更新后的设置。不过总的来说，空闲的系统中应该不会出现注册表活动，因为这样的应用程序实际上违反了最佳实践（Sysinternals提供的Process Monitor工具即可跟踪此类活动并找出“不规矩”的应用程序）。</p>
<p class="zw">注册表通常会在下列情况下被修改。</p>
<p class="zwd"><span style="color: #0092dd">●</span> 虽然不属于一种“修改”，但注册表的初始结构和很多默认设置都是由原型版本的注册表定义的，该原型包含在Windows的安装介质中，会被复制到每一个新安装的系统内。</p>
<p class="zwd"><span style="color: #0092dd">●</span> 应用程序设置工具创建默认应用程序设置，以及反映了安装过程中选择的配置的设置。</p>
<p class="zwd"><span style="color: #0092dd">●</span> 安装设备驱动程序过程中，即插即用系统在注册表中创建设置，借此告诉I/O管理器该如何启动驱动程序，并创建其他设置来配置驱动程序操作（有关设备驱动程序安装方式的详细信息，请参阅本书卷1第6章“I/O系统”）。</p>
<p class="zwd"><span style="color: #0092dd">●</span> 通过用户界面更改应用程序或系统设置后，这些更改通常也会保存在注册表中。</p>

<p class="epubit-contents-id" style="display: none">{"index":1,"parentId":"5a53b69b-1f5b-45b1-989a-6fe8c9cf2a82","id":"0cea07ea-56a9-4f71-bd2e-bdcd231ca1c7"}</p>