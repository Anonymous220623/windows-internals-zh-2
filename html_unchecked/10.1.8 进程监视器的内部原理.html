<h3 class="bt3" id="sigil_toc_id_114">10.1.8　进程监视器的内部原理</h3>
<p class="zw">进程监视器依赖一个设备驱动程序，这个驱动程序是在它运行时从自己的可执行映像中提取并启动的。因此，首次执行该工具时要求账户具备加载驱动程序和调试特权，同一个启动会话中的后续执行只需要调试特权，因为一旦加载后，该驱动程序就会驻留。</p>
<p class="zwtsh">实验：查看闲置系统的注册表活动</p>
<p class="zwts1">由于应用程序可以由注册表实现的RegNotifyChangeKey函数来请求在注册表发生变化后接收通知，而不需要进行轮询，因此，在闲置系统上启动进程监视器后，应该不会看到对同一个注册表键或值进行的重复性访问。如果遇到这样的活动，往往意味着应用程序的质量不高，这也会对系统的整体性能产生负面影响。</p>
<p class="zwts1">请运行进程监视器，确保工具栏中只启用了“<strong style="color:#0092dd">显示注册表活动</strong>”选项（这是为了消除文件系统、网络以及进程或线程产生的噪音），随后等待几秒钟并查看输出的日志，看看能否找到轮询行为。用鼠标右击轮询行为对应的输出项，随后从右键菜单中选择“<strong style="color:#0092dd">进程属性</strong>”即可查看执行该活动进程的详细信息。</p>
<p class="zwtsh">实验：使用进程监视器定位应用程序的注册表设置</p>
<p class="zwts1">在某些排错场景中，我们可能需要判断系统或应用程序将特定设置保存在注册表中的哪个位置。本实验将使用进程监视器来找出记事本设置的保存位置。与大部分Windows应用程序类似，记事本执行过程中会存储用户首选项（如自动换行模式、字体和字号、窗口位置）。通过使用进程监视器在记事本读/写设置时进行实时监视，即可找出存储这些设置的注册表键。请根据下列步骤执行操作。</p>
<p class="zwts1">1）让记事本保存一个我们可以在进程监视器记录中轻松搜索的设置。例如可以运行记事本，将字体设置为Times New Roman，然后退出记事本。</p>
<p class="zwts1">2）运行进程监视器。打开过滤器对话框和Process Name过滤器，随后输入notepad. exe作为要匹配的字符串。点击“<strong style="color:#0092dd">添加</strong>”按钮加以确认。该操作会让进程监视器记录notepad.exe进程的活动。</p>
<p class="zwts1">3）再次运行记事本，启动完成后停止进程监视器的事件捕获，为此请在进程监视器的“<strong style="color:#0092dd">文件</strong>”菜单中点击“<strong style="color:#0092dd">捕获事件</strong>”以将其关闭。</p>
<p class="zwts1">4）滚动至结果日志的第一行并将其选中。</p>
<p class="zwts1">5）按下Ctrl+F，打开“<strong style="color:#0092dd">查找</strong>”对话框，搜索times new。进程监视器会强调显示类似下图所示的一行内容，这表示记事本在从注册表读取字体值。这一行上下的其他操作则与记事本的其他设置有关。</p>
<p class="图"></p>
<img src="../res/pubcloud/5B0A982E/ushu/UBda647ada3435/online/FBOLda82494f5f9f/Images/tx779.png" style="width: 100%" />
<p class="zwts1">6）右击突出显示的行并点击Jump To。进程监视器会启动注册表编辑器（如果尚未启动的话）并直接打开，然后选中记事本引用的这个注册表值。</p>

<p class="epubit-contents-id" style="display: none">{"index":7,"parentId":"5a53b69b-1f5b-45b1-989a-6fe8c9cf2a82","id":"39720a11-b635-4e12-90f7-7a33058d7b73"}</p>