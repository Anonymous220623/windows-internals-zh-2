<h3 class="bt3" id="sigil_toc_id_243">11.10.14　每用户卷配额</h3>
<p class="zw">系统管理员通常需要跟踪或限制用户在共享存储卷上使用的磁盘空间，因此，NTFS提供了配额管理功能。NTFS的配额管理可以为每个用户强制指定配额，借此可以方便地跟踪用量并了解用户何时会触及警报阈值和限制阈值。经过配置，如果用户超过了自己的警报限制，NTFS还可以向系统事件日志中记录一条代表这种情况的事件。类似地，如果用户试图使用超过配额限制的存储容量，NTFS也可以在系统事件日志中记录事件，并且可以让导致配额超限的应用程序文件I/O因为“磁盘已满”的错误而失败。</p>
<p class="zw">NTFS依赖创建文件和目录的用户的安全标识符（SID）来跟踪用户使用的容量（SID的详细信息请参阅卷1第7章）。用户所拥有的文件和目录的逻辑大小会被统计到管理员为用户定义的配额限制中。因此，用户无法通过创建一个大于配额限制的稀疏文件，随后用非零数据填充该文件的方式规避配额限制。类似地，虽然50&nbsp;KB的文件可能压缩到10&nbsp;KB，但在计算配额时将会记作完整的50&nbsp;KB。</p>
<p class="zw">默认情况下，卷并未启用配额跟踪。我们需要使用卷属性对话框的配额选项卡（见图11-25）来启用配额，指定默认的警报和限制阈值，并配置用户达到警报或限制配额后的NTFS行为。从该对话框中打开的配额项工具可供管理员为每个用户指定不同的限制和行为。应用程序如果需要与NTFS配合管理机制交互，则可使用COM配额接口，包括IDiskQuotaControl、IDiskQuotaUser以及IDiskQuotaEvents。</p>
<p class="图"></p>
<img src="../res/pubcloud/5B0A982E/ushu/UBda647ada3435/online/FBOLda82494f5f9f/Images/tx1531.png" style="width: 100%" />
<p class="图题">图11-25　通过卷属性对话框打开的配额设置对话框</p>

<p class="epubit-contents-id" style="display: none">{"index":13,"parentId":"4e1b28f8-e2a9-4fda-aeea-4d6f22a941c7","id":"148215c4-41ca-40af-a42d-eb0ce5557634"}</p>