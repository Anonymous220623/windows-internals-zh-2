<h3 class="bt3" id="sigil_toc_id_301">11.15.6　文件系统过滤器驱动程序和DAX</h3>
<p class="zw">传统的过滤器驱动程序和微型过滤器无法作用于DAX卷。此类驱动程序通常可增强文件系统的功能，经常需要与文件系统驱动程序管理的所有操作进行交互。不同类型的过滤器可以为文件系统驱动程序提供新的功能，或修改现有功能的行为，例如反病毒、加密、复制、压缩、分层存储管理（Hierarchical Storage Management，HSM）等。DAX驱动程序模型大幅更改了DAX卷与这些组件的交互方式。</p>
<p class="zw">如上文所述，文件被映射到内存后，无论是DAX模式下的文件系统，或是位于文件系统驱动程序之上或之下的所有过滤器驱动程序，都无法收到任何读取或写入的I/O请求。这意味着依赖数据拦截的过滤器驱动程序将会失效。为最大限度减少可能的兼容性问题，在挂载了DAX卷后，现有的微型过滤器将无法通过InstanceSetup回调收到通知。如果依然希望作用于DAX卷，则新开发的或更新后的微型过滤器驱动程序在通过FltRegisterFilter这个内核API与过滤器管理器注册时，需要指定FLTFL_REGISTRATION_SUPPORT_DAX_ VOLUME标记。</p>
<p class="zw">决定支持DAX卷的微型过滤器还会面临一个限制：无法拦截任何形式的分页I/O。数据转换过滤器（提供加密或压缩功能）完全无法正确处理内存映射文件；反恶意软件过滤器会受到上文提及的影响，因为必须针对每个打开和关闭操作执行扫描，因此无法判断写入操作是否真正发生（该影响主要涉及对文件最后一次更新时间的检测方面）。传统过滤器已无法兼容：如果驱动程序调用IoAttachDeviceToDevice堆栈API（或类似的函数），I/O管理器会直接让请求失败（并记录一条ETW事件）。</p>

<p class="epubit-contents-id" style="display: none">{"index":5,"parentId":"79bbbed1-3a35-4d22-b579-86536ea07e54","id":"a58e3729-1b94-42a7-8503-2cd0840e7f38"}</p>